runApp()
runApp()
runApp()
runApp()
Comments %>%
count(airline, airline_sentiment) %>%
ggplot(aes(airline, n))+
geom_bar(stat = "identity", colour = "grey19", fill = "skyblue")+
facet_wrap(~airline_sentiment, ncol = 2)+
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 9))+
labs(x = "Airlines", y = "Count of Tweet Sentiments")
Comments %>%
group_by(airline_sentiment) %>%
count(airline) %>%
geom_bar(stat = "identity", colour = "grey19", fill = "skyblue")
Comments %>%
group_by(airline_sentiment) %>%
count(airline)
Comments %>%
group_by(airline_sentiment) %>%
count(airline) %>%
filter(airline_sentiment = 'negative') %>%
ggplot() +
geom_bar(stat = "identity", aes(color = airline))
Comments %>%
group_by(airline_sentiment) %>%
count(airline) %>%
filter(airline_sentiment =='negative') %>%
ggplot() +
geom_bar(stat = "identity", aes(color = airline))
Comments %>%
group_by(airline_sentiment) %>%
count(airline) %>%
filter(airline_sentiment =='negative') %>%
ggplot() +
geom_col(aes(color = airline))
Comments %>%
group_by(airline_sentiment) %>%
count(airline) %>%
filter(airline_sentiment =='negative') %>%
ggplot(aes(x = airline, y = n)) +
geom_col(aes(color = airline))
Comments %>%
group_by(airline_sentiment) %>%
count(airline) %>%
filter(airline_sentiment =='negative') %>%
ggplot(aes(x = airline, y = n)) +
geom_col(aes(fill = airline))
Comments %>%
group_by(airline_sentiment) %>%
count(airline) %>%
filter(airline_sentiment =='negative') %>%
ggplot(aes(x = airline, y = n)) +
geom_col(aes(fill = airline)) +
ylab("negative")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
Comments %>%
ggplot(aes(airline_sentiment))+
geom_bar(aes(fill = airline))+
labs(x = "Airline Sentiment", y = "Count", fill = "Airlines")
Comments %>%
ggplot(aes(airline_sentiment))+
geom_bar(fill = "tomato", color = "black")+
labs(x = "Airline Sentiment", y = "Count")
runApp()
runApp()
runApp()
output$AA <- renderPlot({
Comments %>% filter(airline == 'American')%>%
anti_join(stop_words) %>%
count(word) %>%
with(wordcloud(word, n, max.words = 50))
output$AA <- renderPlot({
Comments %>% filter(airline == 'American')%>%
anti_join(stop_words) %>%
count(word) %>%
with(wordcloud(word, n, max.words = 50))
text_df <- data_frame(line = 1:nrow(Comments), airline=Comments$airline, text = Comments$text )
grouped_text <- unnest_tokens(text_df,word, text)
output$AA <- renderPlot({
grouped_text %>% filter(airline == 'American')%>%
anti_join(stop_words) %>%
count(word) %>%
with(wordcloud(word, n, max.words = 50))
runApp()
runApp()
runApp()
ggplot(tweets, aes(x = text_length,
fill = airline_sentiment)) +
geom_density(alpha = 0.2) +
scale_fill_manual(name   = 'Tweet\nSentiment',
values = sentPlt,
breaks = sentBreaks) +
geom_vline(xintercept = 170,
lwd=1, lty = 'dashed') +
labs(x = 'Tweet Length') +
theme_few() +
theme(text = element_text(size=12))
ggplot(tweets, aes(x = text_length,
fill = airline_sentiment)) +
geom_density(alpha = 0.2) +
scale_fill_manual(name   = 'Tweet\nSentiment',
values <- c('#f93822','#fedd00','#27e833'),
breaks <- c('positive','neutral','negative')) +
geom_vline(xintercept = 170,
lwd=1, lty = 'dashed') +
labs(x = 'Tweet Length') +
theme_few() +
theme(text = element_text(size=12))
ggplot(tweets, aes(x = text_length,
fill = airline_sentiment)) +
geom_density(alpha = 0.2) +
scale_fill_manual(name   = 'Tweet\nSentiment',
values <- c('#f93822','#fedd00','#27e833'),
breaks <- c('positive','neutral','negative')) +
geom_vline(xintercept = 170,
lwd=1, lty = 'dashed') +
labs(x = 'Tweet Length') +
theme(text = element_text(size=12))
library(ggplot2)
library(dplyr)
# convert matrix to dataframe
state_stat <- data.frame(state.name = rownames(state.x77), state.x77)
# remove row names
rownames(state_stat) <- NULL
# create variable with colnames as choice
choice <- colnames(state_stat)[-1]
tweets = read.csv("./Tweets.csv")
# Create a variable holding the number of `@` characters in each tweet
tweets$at_count <- sapply(tweets$text, function(x) str_count(x, '@'))
maxAt <- max(tweets$at_count)
# Collapse number of 'ats'that are
tweets$at_countD[tweets$at_count == 1] <- '1'
tweets$at_countD[tweets$at_count == 2] <- '2'
tweets$at_countD[tweets$at_count %in% c(3:maxAt)] <- '3+'
# Change to a factor variable
tweets$at_countD <- factor(tweets$at_countD)
# Store the length of each tweet
tweets$text_length <- sapply(tweets$text, function(x) nchar(x))
library(DT)
library(shiny)
library(googleVis)
library(dplyr)
library(tidytext)
library(RColorBrewer)
library(ggplot2)
library(wordcloud)
library(tm)
library(tidyverse)
library(plotly)
library(maps)
library(rbokeh)
library(widgetframe)
library(htmlwidgets)
# convert matrix to dataframe
state_stat <- data.frame(state.name = rownames(state.x77), state.x77)
# remove row names
rownames(state_stat) <- NULL
# create variable with colnames as choice
choice <- colnames(state_stat)[-1]
tweets = read.csv("./Tweets.csv")
# Create a variable holding the number of `@` characters in each tweet
tweets$at_count <- sapply(tweets$text, function(x) str_count(x, '@'))
maxAt <- max(tweets$at_count)
# Collapse number of 'ats'that are
tweets$at_countD[tweets$at_count == 1] <- '1'
tweets$at_countD[tweets$at_count == 2] <- '2'
tweets$at_countD[tweets$at_count %in% c(3:maxAt)] <- '3+'
# Change to a factor variable
tweets$at_countD <- factor(tweets$at_countD)
# Store the length of each tweet
tweets$text_length <- sapply(tweets$text, function(x) nchar(x))
library(DT)
library(shiny)
library(googleVis)
library(dplyr)
library(tidytext)
library(RColorBrewer)
library(ggplot2)
library(wordcloud)
library(tm)
library(tidyverse)
library(plotly)
library(maps)
library(rbokeh)
library(widgetframe)
library(htmlwidgets)
# convert matrix to dataframe
state_stat <- data.frame(state.name = rownames(state.x77), state.x77)
# remove row names
rownames(state_stat) <- NULL
# create variable with colnames as choice
choice <- colnames(state_stat)[-1]
tweets = read.csv("./Tweets.csv")
# Create a variable holding the number of `@` characters in each tweet
tweets$at_count <- sapply(tweets$text, function(x) str_count(x, '@'))
maxAt <- max(tweets$at_count)
# Collapse number of 'ats'that are
tweets$at_countD[tweets$at_count == 1] <- '1'
tweets$at_countD[tweets$at_count == 2] <- '2'
tweets$at_countD[tweets$at_count %in% c(3:maxAt)] <- '3+'
# Change to a factor variable
tweets$at_countD <- factor(tweets$at_countD)
# Store the length of each tweet
tweets$text_length <- sapply(tweets$text, function(x) nchar(x))
output$at <- renderPlot({
ggplot(tweets, aes(x = text_length,
fill = airline_sentiment)) +
geom_density(alpha = 0.2) +
scale_fill_manual(name   = 'Tweet\nSentiment',
values <- c('#f93822','#fedd00','#27e833'),
breaks <- c('positive','neutral','negative')) +
geom_vline(xintercept = 170,
lwd=1, lty = 'dashed') +
labs(x = 'Tweet Length') +
theme(text = element_text(size=12))
ggplot(tweets, aes(x = text_length,
fill = airline_sentiment)) +
geom_density(alpha = 0.2) +
scale_fill_manual(name   = 'Tweet\nSentiment',
values <- c('#f93822','#fedd00','#27e833'),
breaks <- c('positive','neutral','negative')) +
geom_vline(xintercept = 170,
lwd=1, lty = 'dashed') +
labs(x = 'Tweet Length') +
theme(text = element_text(size=12))
tweets %>%
filter(!is.na(negativereason)) %>%
count(airline, negativereason) %>%
ggplot(aes(negativereason, n))+
geom_bar(stat = "identity", colour = "grey19", fill = "springgreen4")+
facet_wrap(~airline, ncol = 3)+
theme(axis.text.x = element_text(angle = 30, hjust = 1, size = 9))+
labs(x = "Negative Reasons", y = "Count of Negative Reasons")
runApp()
output$at <- renderPlot({
tweets %>%
filter(!is.na(negativereason)) %>%
count(airline, negativereason) %>%
ggplot(aes(negativereason, n))+
geom_bar(stat = "identity", colour = "grey19", fill = "springgreen4")+
facet_wrap(~airline, ncol = 3)+
theme(axis.text.x = element_text(angle = 30, hjust = 1, size = 9))+
labs(x = "Negative Reasons", y = "Count of Negative Reasons")
runApp()
runApp()
runApp()
runApp()
runApp()
tweets %>%
filter(!is.na(negativereason)) %>%
count(airline, negativereason) %>%
ggplot(aes(negativereason, n))+
geom_bar(stat = "identity", colour = "grey19", fill = "springgreen4")+
facet_wrap(~airline, ncol = 3)+
theme(axis.text.x = element_text(angle = 30, hjust = 1, size = 9))+
labs(x = "Negative Reasons", y = "Count of Negative Reasons")
runApp()
runApp()
text_df <- data_frame(line = 1:nrow(tweets), airline=tweets$airline, text = tweets$text )
grouped_text <- unnest_tokens(text_df,word, text)
grouped_text %>% filter(airline == 'American')%>%
anti_join(stop_words) %>%
count(word) %>%
with(wordcloud(word, n, max.words = 50))
runApp()
text_df <- data_frame(line = 1:nrow(tweets), airline=tweets$airline, text = tweets$text )
grouped_text <- unnest_tokens(text_df,word, text)
grouped_text %>% filter(airline == 'American')%>%
anti_join(stop_words) %>%
count(word) %>%
with(wordcloud(word, n, max.words = 50))
text_df <- data_frame(line = 1:nrow(tweets), airline=tweets$airline, text = tweets$text )
grouped_text <- unnest_tokens(text_df,word, text)
grouped_text %>% filter(airline == 'American')%>%
anti_join(stop_words) %>%
count(word) %>%
with(wordcloud(word, n, max.words = 50))
runApp()
options(repr.plot.width = 10, repr.plot.height = 7)
require(maps)
states <- map_data("state")
ggplot()+
geom_polygon(data = states, aes(x = long, y = lat, group = group), colour="black", fill = 'lightblue')+
ggtitle("Location of tweets across the United States")+
geom_point(data = location_2, aes(x = long, y = lat, size = n), color="coral1") + scale_size(name="Total Tweets")+
xlim(-125, -65) + ylim(25, 50)
require(maps)
world_map <- map_data("world")
g1 = ggplot()
g1 = g1 + geom_polygon(data=world_map, aes(x=long, y=lat, group = group), colour="black", fill = 'lightblue') +
ggtitle("Location of tweets across the World")
g1 = g1 + geom_point(data=location, aes(x=long, y=lat, size = count), color="coral1") + scale_size(name="Total Tweets")
g1 = g1 + ylim(-50, 80)
states <- map_data("state")
g2 = ggplot()
g2 =g2 + geom_polygon(data=states, aes(x=long, y=lat, group = group), colour="black", fill = 'lightblue') +
ggtitle("Location of tweets across the States")
g2 = g2 + geom_point(data=location, aes(x=long, y=lat, size = count), color="coral1") + scale_size(name="Total Tweets")
g2 = g2 + xlim(-125, -65) + ylim(25, 50)
graph_material_American <- subset(graph_material_2,Airline=="American")
ggplot(graph_material_American,aes(x=Airline,y=Proportion_of_Negative_Reason,fill=Negative_Reason))+geom_bar(stat="identity",position="dodge")
runApp()
runApp()
output$negative <- renderPlot({
ggplot(tweets, aes(x = at_countD, fill = airline_sentiment)) +
geom_bar(position = 'fill', colour = 'black') +
facet_wrap(~airline) +
scale_fill_manual(name   = 'Tweet\nSentiment',
values = sentPlt,
breaks = sentBreaks) +
labs(x = 'Number of @s', y = 'Proportion') +
theme_few() +
theme(text = element_text(size=12))
geom_bar(position = 'fill', colour = 'black') +
facet_wrap(~airline) +
scale_fill_manual(name   = 'Tweet\nSentiment',
values = sentPlt,
breaks = sentBreaks) +
labs(x = 'Number of @s', y = 'Proportion') +
theme_few() +
theme(text = element_text(size=12))
ggplot(tweets, aes(x = at_countD, fill = airline_sentiment)) +
geom_bar(position = 'fill', colour = 'black') +
facet_wrap(~airline) +
scale_fill_manual(name   = 'Tweet\nSentiment',
values = sentPlt,
breaks = sentBreaks) +
labs(x = 'Number of @s', y = 'Proportion') +
theme(text = element_text(size=12))
ggplot(tweets, aes(x = at_countD, fill = airline_sentiment)) +
geom_bar(position = 'fill', colour = 'black') +
facet_wrap(~airline) +
scale_fill_manual(name = 'Tweet\nSentiment',
values = sentPlt,
breaks = sentBreaks) +
labs(x = 'Number of @s', y = 'Proportion') +
theme(text = element_text(size=12))
ggplot(tweets, aes(x = at_countD, fill = airline_sentiment)) +
geom_bar(position = 'fill', colour = 'black') +
facet_wrap(~airline) +
scale_fill_manual(name = 'Tweet\nSentiment',
values = sentPlt,
breaks = sentBreaks) +
labs(x = 'Number of @s', y = 'Proportion') +
theme(text = element_text(size=12))
ggplot(tweets, aes(x = at_countD, fill = airline_sentiment)) +
geom_bar(position = 'fill', colour = 'black') +
facet_wrap(~airline) +
scale_fill_manual(name = 'Tweet\nSentiment',
values <- c('#f93822','#fedd00','#27e833'),
breaks <- c('positive','neutral','negative')) +
labs(x = 'Number of @s', y = 'Proportion') +
theme(text = element_text(size=12))
ggplot(tweets, aes(x = text_length,
fill = airline_sentiment)) +
geom_density(alpha = 0.2) +
facet_wrap(~airline, scale = 'free') +
scale_fill_manual(name   = 'Tweet\nSentiment',
values = sentPlt,
breaks = sentBreaks) +
labs(x = 'Tweet Length') +
theme_few() +
theme(text = element_text(size=12))
ggplot(tweets, aes(x = text_length,
fill = airline_sentiment)) +
geom_density(alpha = 0.2) +
facet_wrap(~airline, scale = 'free') +
scale_fill_manual(name   = 'Tweet\nSentiment',
values <- c('#f93822','#fedd00','#27e833'),
breaks <- c('positive','neutral','negative')) +
labs(x = 'Tweet Length') +
theme_few() +
theme(text = element_text(size=12))
ggplot(tweets, aes(x = text_length,
fill = airline_sentiment)) +
geom_density(alpha = 0.2) +
facet_wrap(~airline, scale = 'free') +
scale_fill_manual(name   = 'Tweet\nSentiment',
values <- c('#f93822','#fedd00','#27e833'),
breaks <- c('positive','neutral','negative')) +
labs(x = 'Tweet Length') +
theme(text = element_text(size=12))
runApp()
dataset$length = nchar(as.character(dataset$text))
ggplot(dataset, aes(x = length,
fill = airline_sentiment))+
geom_density(alpha = 0.5)+
scale_x_continuous(name   = 'Tweet\nSentiment') +
labs(x = 'Tweet Length') +
theme(text = element_text(size=12))
ggplot(tweets, aes(x = text_length,
fill = airline_sentiment)) +
geom_density(alpha = 0.2) +
facet_wrap(~airline, scale = 'free') +
scale_fill_manual(name   = 'Tweet\nSentiment',
values <- c('#f93822','#fedd00','#27e833'),
breaks <- c('positive','neutral','negative')) +
labs(x = 'Tweet Length') +
theme(text = element_text(size=12))
require(maps)
world_map <- map_data("world")
g1 = ggplot()
g1 = g1 + geom_polygon(data=world_map, aes(x=long, y=lat, group = group), colour="black", fill = 'lightblue') +
ggtitle("Location of tweets across the World")
g1 = g1 + geom_point(data=location, aes(x=long, y=lat, size = count), color="coral1") + scale_size(name="Total Tweets")
g1 = g1 + ylim(-50, 80)
states <- map_data("state")
g2 = ggplot()
g2 =g2 + geom_polygon(data=states, aes(x=long, y=lat, group = group), colour="black", fill = 'lightblue') +
ggtitle("Location of tweets across the States")
g2 = g2 + geom_point(data=location, aes(x=long, y=lat, size = count), color="coral1") + scale_size(name="Total Tweets")
g2 = g2 + xlim(-125, -65) + ylim(25, 50)
#grid.arrange(g, ncol=1, nrow = 2)
grid.arrange(g1, g2, ncol=1, nrow = 2)
library(ggplot2)
library(gridExtra)
require(maps)
world_map <- map_data("world")
g1 = ggplot()
g1 = g1 + geom_polygon(data=world_map, aes(x=long, y=lat, group = group), colour="black", fill = 'lightblue') +
ggtitle("Location of tweets across the World")
g1 = g1 + geom_point(data=location, aes(x=long, y=lat, size = count), color="coral1") + scale_size(name="Total Tweets")
g1 = g1 + ylim(-50, 80)
states <- map_data("state")
g2 = ggplot()
g2 =g2 + geom_polygon(data=states, aes(x=long, y=lat, group = group), colour="black", fill = 'lightblue') +
ggtitle("Location of tweets across the States")
g2 = g2 + geom_point(data=location, aes(x=long, y=lat, size = count), color="coral1") + scale_size(name="Total Tweets")
g2 = g2 + xlim(-125, -65) + ylim(25, 50)
#grid.arrange(g, ncol=1, nrow = 2)
grid.arrange(g1, g2, ncol=1, nrow = 2)
text_df <- data_frame(line = 1:nrow(mydata), airline=mydata$airline, text = mydata$text )
grouped_text <- unnest_tokens(text_df,word, text)
grouped_text %>% filter(airline == 'American')%>%
anti_join(stop_words) %>%
count(word) %>%
with(wordcloud(word, n, max.words = 50))
text_df <- data_frame(line = 1:nrow(tweets), airline=tweets$airline, text = tweets$text )
grouped_text <- unnest_tokens(text_df,word, text)
grouped_text %>% filter(airline == 'American')%>%
anti_join(stop_words) %>%
count(word) %>%
with(wordcloud(word, n, max.words = 50))
text_df <- data_frame(line = 1:nrow(tweets), airline=tweets$airline, text = tweets$text )
grouped_text <- unnest_tokens(text_df,word, text)
grouped_text %>% filter(airline == 'American')%>%
anti_join(stop_words) %>%
count(word) %>%
with(wordcloud(word, n, max.words = 50))
runApp()
runApp()
View(state_stat)
View(states)
View(tweets)
View(tweets)
View(tweets)
View(tweets)
View(tweets)
View(tweets)
View(tweets)
tweets = read.csv("./Tweets.csv")
View(tweets)
View(tweets)
tweets %>%
ggplot(aes(airline_sentiment))+
geom_bar(fill = "tomato", color = "black")+
labs(x = "Airline Sentiment", y = "Count")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
ggplot(tweets, aes(x = airline_sentiment, fill = airline_sentiment)) +
geom_bar() +
facet_grid(. ~ airline) +
theme(axis.text.x = element_text(angle=65, vjust=0.6),
plot.margin = unit(c(3,0,3,0), "cm"))
ggplot(tweets, aes(x = airline_sentiment, fill = airline_sentiment)) +
geom_bar() +
facet_grid(. ~ airline) +
theme(axis.text.x = element_text(angle=65, vjust=0.6),
plot.margin = unit(c(3,0,3,0), "cm"))
runApp()
runApp()
ggplot(tweets, aes(x = airline_sentiment, fill = airline_sentiment)) +
geom_bar() +
facet_grid(. ~ airline) +
theme(axis.text.x = element_text(angle=65, vjust=0.6),
plot.margin = unit(c(3,0,3,0), "cm"))
runApp()
